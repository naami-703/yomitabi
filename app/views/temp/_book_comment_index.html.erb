<table>
  <% if book.present? %>
    <% if book.comments.any? %>
      <tr>
        <th>投稿者</th>
        <th>コメント</th>
        <th>スポット画像</th>
        <th>投稿日</th>
        <th></th>
      </tr>
      <% book.comments.order(created_at: :desc).each do |comment| %>
        <tr>
          <td>
            <div class="profile_image">
              <% if comment.user == current_user %>
                <%= link_to mypage_users_path do %>
                  <%= image_tag comment.user.get_profile_image(80,80) %><br>
                  <%= comment.user.name %>
                <% end %>
              <% else %>
                <%= link_to user_path(user) do %>
                  <%= image_tag comment.user.get_profile_image(80,80) %><br>
                  <%= comment.user.name %>
                <% end %>
              <% end %>
            </div>
          </td>
            <td><%= comment.comment %></td>
            <td><%= comment.created_at.strftime('%Y/%m/%d') %></td>
              <% if admin_signed_in? %>
                <td><%= link_to "削除", admin_comment_path(book_id: book.id, id: comment.id), method: :delete, class: 'btn btn-danger mb-3', role: 'button' %></td>
                <% elsif user_signed_in? && current_user == comment.user %>
                <td><%= link_to "削除", book_comment_path(book_id: book.id, id: comment.id), method: :delete, class: 'btn btn-danger mb-3', role: 'button', remote: true %></td>
                <% else %>
                <% end %>
              <% end %>
              <% else %>
              <p>コメントがありません</p>
          </tr>
        <% end %>
    <% else %>
  <% end %>
</table>
